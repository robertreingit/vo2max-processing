---
title: ''
output: pdf_document
bibliography: ../references.bib
---

# Methods

The work presented in this thesis was preregistered before the start of the project on [OSF](). Any deviations from the preregistration are indicated in the 'Transparent Changes' document (LINK/Appendix). All data and code can be found at [GitHub](https://www.github.com/smnnlt/vo2max-processing).

<!-- explicitly state deviations from preregistration -->

## Systematic Scoping Review

<!-- Detailed Aim of review -->

### Search & Screening

To assess the current state of data processing methods for determining V̇O~2max~ in exercise science I systematically screened recent literature. The article search was conducted on 16th March 2022 using [PubMed]() and [Web of Science](). The search included articles published from 2017 to 2022 referring to 'maximum oxygen uptake' or equivalent terms in title, abstract or keyword. Table 1 shows the exact search terms.

```{r terms, echo = FALSE}
out <- data.frame(
  source = c("PubMed", "Web of Science"),
  term = c('((((("maximum oxygen uptake") OR ("maximal oxygen uptake")) OR ("VO2max")) OR ("maximum oxygen consumption")) OR ("maximal oxygen consumption")) AND (("2017/01/01"[Date - Publication] : "3000"[Date - Publication]))', '(((((ALL=("maximum oxygen uptake")) OR ALL=("maximal oxygen uptake")) OR ALL=("VO2max")) OR ALL=("maximum oxygen consumption")) OR ALL=("maximal oxygen consumption")) AND PY=(2017-2022)')
)

knitr::kable(out, 
  col.names = c("Source", "Search String"), 
  caption = "Search strings for the systematic scoping review.")
```

The search results from both data bases were joined at checked for the presence of a DOI. Entries without DOI were excluded, to allow for automated removal of duplicates by DOI matching in the next step. After the removal of duplicates I conducted an automated title scanning to remove results that are likely no original research articles. Table 2 displays the exclusion terms during the automated title screening.

```{r titlescan, echo = FALSE}
out <- data.frame(
  term = c("review, correction, meta-analysis, comment, retraction, editorial, erratum, reply")
)

knitr::kable(out, 
  col.names = c("Search terms for exclusion by title"), 
  caption = "Exclusion terms during automated title screening after removal of duplicates. If an articles title matched least one of the given terms, it was excluded.")
```

In accordance with the preregistration a random sample was drawn from the search results. The goal of the random sample was to give an unbiased sample of the current state of scientific V̇O~2max~ testing. Based on the procedure described in the preregistration file (LINK), the sample included a total of 500 articles.

The abstracts from the articles included in the random sample were blinded for scanning. This included the removal of any further information not relevant for the screening---such as authors or journals---leaving only the title, abstract and an ID of the articles (see Figure 2). Two researchers independently scanned the abstracts to filter those that matched one of the exclusion criteria shown in Table 3. When the screeners disagreed in their assessments, conflicts were resolved by discussion.

After the abstract screening I retrieved the full-texts for all articles remaining in the review. The full-texts were again independently scanned by two researchers to include only those articles that measured V̇O~2max~ using an appropriate testing procedure in humans (see Table 3 for the full-text exclusion criteria). Conflicts were resolved by discussion.

All data exclusion steps are documented under XXXLINK.

### Data Extraction

I retrieved data from all articles remaining after the abstract and full-text screening. Extraction included the following data:

-   metabolic cart used

-   type of metabolic cart/data basis (breath-by-breath, mixed chamber, ...)

-   type of outcome for V̇O~2max~ (primary, secondary, other)

-   preprocessing algorithm

-   data processing software

-   interpolation procedure

-   data processing/determination of V̇O~2max~:

    -   type (time average, breath average, digital filtering)
    -   alignment (rolling, binned, ...)
    -   interval (in sec/breath, parameters for filtering)
    -   interpolation procedure

-   reference for the used data processing strategy

All extracted data is available in the Appendix A and under XXXLINK.

### Data Synthesis

<!-- presentation of data -->

## Experimental Comparison

To determine the influence the most common data processing strategies have on the determination V̇O~2max~, I compared them on a set of already collected gas exchange data from running.

### Data Source

A total of N = 72 exercise test were analysed for this study. The data was from previous research on the metabolic profile of endurance runners [@quittmann_unpubl_a; @quittmann_unpubl_b]. The tested individuals were experienced distance runners (XXX male, XXX female; XXX two times). The V̇O~2max~ tests were conducted in XXX to September 2019 [@quittmann_unpubl_a] and March to October 2021 [@quittmann_unpubl_b] using the same protocol. Participants run on a treadmill (XXX) with 1% inclination for ten minutes at a velocity of 2.8 m/s as a warm-up. After placing the mask for the gas exchange measures, they started a ramp protocol with an initial speed of 2.8 m/s for two minutes and subsequently velocity increased by 0.15 m/s every 30 seconds. The researchers provided verbal encouragement and terminated the exercise when the participants reached subjective exhaustion.

Gas exchange data were recorded using a ZAN XXX device (XXX). The device was calibrated with a 3l-syringe pump (XXX) and a reference gas (XXX) before each measurement. The measured breath-by-breath data is available at XXXLINK.

### Data Processing

The spiro Package for R [@nolte2022a] processed the raw gas exchange data. It includes various algorithms to calculate V̇O~2max~ with user-defined parameters on given data. Table 4 displays a brief summary exemplary function parameters used for the analysis. The full analysis script is available at XXXLINK.

#### Time based averaging

#### Breath based averaging

#### Butterworth filtering

### Comparison of methods

To compare different processing methods within and between individuals, I choose to express the V̇O~2max~ normalized to a reference procedure. The reference procedure was chosen as being the most commonly applied in current literature as determined by the systematic review. Individual V̇O~2max~ values were expressed in reference to this procedure, where a value of 1 means that the processing method yields exactly the same V̇O~2max~ value as the reference method. I calculated the data for all integer parameter values within the range of the values found in the literature during the review. On a group level I calculated the median and 2.5 and 97.5-quantiles of each processing strategy.
